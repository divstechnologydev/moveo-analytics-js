!function(e){if(e.MoveoOne)return;const t="https://dev-api.moveo.one/api/analytic/event/tag",i="1.0.2";class n{constructor(t){this.token=t,this.userId="",this.buffer=[],this.flushInterval=5e3,this.maxThreshold=100,this.context="WEB_STATIC",this.sessionId=this.getOrCreateSessionId(),this.started=!1,this.pendingUpdates=[],this.meta={libVersion:i},this.additionalMeta={},this.currentViewport={width:e.innerWidth,height:e.innerHeight},this.isPageNavigation=this.checkIfPageNavigation(),this.impressionObserver=null,this.seenElements=new WeakSet,this.pendingImpressions=[],this.pendingImmediateEvents=[],setInterval((()=>this.flush()),this.flushInterval)}getOrCreateSessionId(){const e="moveo-session-id",t="moveo-session-timestamp",i=localStorage.getItem(e),n=localStorage.getItem(t);if(i&&n){const e=Date.now();if(e-parseInt(n,10)<18e5)return localStorage.setItem(t,e.toString()),this.isExistingSession=!0,i}this.isExistingSession=!1;const a=this.generateUUID();return localStorage.setItem(e,a),localStorage.setItem(t,Date.now().toString()),a}checkIfPageNavigation(){const t="moveo-last-path",i=localStorage.getItem(t),n=e.location.pathname;return localStorage.setItem(t,n),i&&i!==n}updateSessionActivity(){localStorage.setItem("moveo-session-timestamp",Date.now().toString())}initialize(){this.start(),this.setupClickTracking(),this.setupDownloadOrOutboundLinkTracking(),this.setupScrollTracking(),this.setupFormTracking(),this.setupHoverTracking(),this.setupResizeTracking(),this.setupPageUnloadTracking(),this.setupMediaTracking(),this.setupClipboardTracking(),this.initImpressionObserver()}identify(e){this.userId=e}setLocale(e){this.meta.locale=e,this.meta.libVersion=i,this.queueOrSendUpdate("meta")}setTest(e){this.meta.test=e,this.meta.libVersion=i,this.queueOrSendUpdate("meta")}setSoftwareVersion(e){this.meta.softwareVersion=e,this.meta.libVersion=i,this.queueOrSendUpdate("meta")}queueOrSendUpdate(e){this.started?"meta"===e?this.addUpdateMetadataEvent():"additional"===e&&this.addUpdateAdditionalMetadataEvent():this.pendingUpdates.push(e)}processPendingUpdates(){[...new Set(this.pendingUpdates)].forEach((e=>{"meta"===e?this.addUpdateMetadataEvent():"additional"===e&&this.addUpdateAdditionalMetadataEvent()})),this.pendingUpdates=[]}processPendingImpressions(){this.pendingImpressions&&this.pendingImpressions.length>0&&(this.pendingImpressions.forEach((({el:e,rect:t,action:i,timestamp:n})=>{this.sendAutoImpressionWithTimestamp(e,t,i,n)})),this.pendingImpressions=[])}processPendingImmediateEvents(){this.pendingImmediateEvents&&this.pendingImmediateEvents.length>0&&(this.pendingImmediateEvents.forEach((({type:e,data:t,timestamp:i})=>{this.trackImmediateWithTimestamp(e,t,i)})),this.pendingImmediateEvents=[])}trackImmediateWithTimestamp(t,i,n){this.updateSessionActivity();const a={c:this.context,type:"track",userId:this.userId,t:n,prop:{sg:i.semanticGroup||"global",eID:i.id,eA:i.action,eT:i.type,eV:i.value||"",sc:e.location.pathname||"unknown"},sId:this.sessionId};this.sendEventImmediate(a)}sendAutoImpressionWithTimestamp(t,i,n,a){let s="";s=t.matches("img")?t.alt||t.title||this.getFilenameFromUrl(t.currentSrc||t.src)||"image":t.matches("video")?t.title||this.getFilenameFromUrl(t.currentSrc||t.src)||"video":t.matches("iframe")?t.title||this.getFilenameFromUrl(t.src)||"embedded_content":t.matches("a")?(t.innerText||t.textContent||"").trim()||t.href||"link":t.matches('button,input,[role="button"]')?(t.innerText||t.value||t.getAttribute("aria-label")||"").trim()||"button":t.matches("h1,h2,h3")?(t.innerText||t.textContent||"").trim()||"heading":(t.innerText||t.textContent||"").trim()||"text";const o={semanticGroup:this.getSemanticGroup(t),id:this.generateStableElementId(t),type:t.tagName.toLowerCase(),action:n,value:s},r={c:this.context,type:"track",userId:this.userId,t:a,prop:{sg:o.semanticGroup,eID:o.id,eA:o.action,eT:o.type,eV:o.value,sc:e.location.pathname||"unknown"},sId:this.sessionId};this.buffer.push(r),this.flushOrRecord(!1)}addUpdateMetadataEvent(){const e={...this.meta,libVersion:i},t={c:this.context,type:"update_metadata",userId:this.userId,t:Date.now(),prop:{},meta:e,additionalMeta:{...this.additionalMeta},sId:this.sessionId};this.buffer.push(t),this.flushOrRecord(!1)}updateAdditionalMetadata(e){this.additionalMeta={...this.additionalMeta,...e},this.queueOrSendUpdate("additional")}addUpdateAdditionalMetadataEvent(){const e={...this.meta,libVersion:i},t={c:this.context,type:"update_metadata",userId:this.userId,t:Date.now(),prop:{},meta:e,additionalMeta:{...this.additionalMeta},sId:this.sessionId};this.buffer.push(t),this.flushOrRecord(!1)}updateMetadata(e){this.updateAdditionalMetadata(e)}flushOrRecord(e=!1){(e||this.buffer.length>=this.maxThreshold)&&this.flush()}track(t,i){this.updateSessionActivity();const n={c:this.context,type:"track",userId:this.userId,t:Date.now(),prop:{sg:i.semanticGroup||"global",eID:i.id,eA:i.action,eT:i.type,eV:i.value||"",sc:e.location.pathname||"unknown"},sId:this.sessionId};this.buffer.push(n),this.buffer.length>=this.maxThreshold&&(this.started?this.flush():console.warn("MoveoOne: Buffer threshold reached before session started, waiting..."))}trackImmediate(t,i){if(!this.started)return void this.pendingImmediateEvents.push({type:t,data:i,timestamp:Date.now()});this.updateSessionActivity();const n={c:this.context,type:"track",userId:this.userId,t:Date.now(),prop:{sg:i.semanticGroup||"global",eID:i.id,eA:i.action,eT:i.type,eV:i.value||"",sc:e.location.pathname||"unknown"},sId:this.sessionId};i.metadata&&(n.additionalMeta={...n.additionalMeta,...i.metadata}),this.sendEventImmediate(n)}sendEventImmediate(e){const i=JSON.stringify({events:[e]});fetch(t,{method:"POST",headers:{Authorization:this.token,"Content-Type":"application/json"},body:i,keepalive:!0}).catch((e=>console.error("MoveoOne Immediate Error:",e)))}enrichWithGeolocation(){return fetch("https://ipapi.co/json/").then((e=>e.json())).then((e=>({location:e.country_name||""}))).catch((e=>(console.warn("MoveoOne: Failed to enrich geolocation",e),{location:""})))}async start(){if(this.isPageNavigation)return await this.trackPageNavigation(),this.started=!0,this.processPendingUpdates(),this.processPendingImpressions(),this.processPendingImmediateEvents(),void(this.buffer.length>=this.maxThreshold&&this.flush());if(this.isExistingSession)return this.started=!0,this.processPendingUpdates(),this.processPendingImpressions(),this.processPendingImmediateEvents(),this.buffer.length>=this.maxThreshold&&this.flush(),this.track("page_view",{semanticGroup:"global",id:this.generateGlobalEventId("page_view",{path:e.location.pathname}),type:"page",action:"page_view",value:e.location.pathname}),void this.track("viewport_size",{semanticGroup:"global",id:this.generateGlobalEventId("viewport_size",{path:e.location.pathname}),type:"viewport",action:"viewport_size",value:`${this.currentViewport.width}x${this.currentViewport.height}`});const t={...this.meta,libVersion:i},n={c:this.context,type:"start_session",userId:this.userId,t:Date.now(),prop:{},meta:t,additionalMeta:{...this.additionalMeta},sId:this.sessionId},a=new URLSearchParams(e.location.search),s={utm_source:a.get("utm_source")||"",utm_medium:a.get("utm_medium")||"",utm_campaign:a.get("utm_campaign")||"",utm_term:a.get("utm_term")||"",utm_content:a.get("utm_content")||""},o="true"===localStorage.getItem("moveo-returning");o||localStorage.setItem("moveo-returning","true");const r={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language||navigator.userLanguage,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,referrer:document.referrer||"",returningVisitor:o},c={screenWidth:e.screen.width,screenHeight:e.screen.height,screenColorDepth:e.screen.colorDepth,devicePixelRatio:e.devicePixelRatio||1},d=await this.enrichWithGeolocation();n.additionalMeta={...n.additionalMeta,...s,...r,...c,...d,title:document.title},this.additionalMeta={...this.additionalMeta,...n.additionalMeta},this.buffer.push(n),this.started=!0,this.processPendingUpdates(),this.processPendingImpressions(),this.processPendingImmediateEvents(),this.buffer.length>=this.maxThreshold&&this.flush(),this.flush(),this.track("page_view",{semanticGroup:"global",id:this.generateGlobalEventId("page_view",{path:e.location.pathname}),type:"page",action:"page_view",value:document.title}),this.track("viewport_size",{semanticGroup:"global",id:this.generateGlobalEventId("viewport_size",{path:e.location.pathname}),type:"viewport",action:"viewport_size",value:`${this.currentViewport.width}x${this.currentViewport.height}`})}initImpressionObserver(){const t=["img[src]","video",'iframe[src*="youtube"], iframe[src*="vimeo"]','a[href]:not([href="#"])','button, input[type=button i], input[type=submit i], [role="button"]',"h1, h2, h3"],i=new Map,n=(()=>{let e;return t=>{cancelAnimationFrame(e),e=requestAnimationFrame(t)}})();this.impressionObserver=new IntersectionObserver((e=>{n((()=>{e.forEach((e=>{if(e.isIntersecting&&!this.seenElements.has(e.target)){const t=setTimeout((()=>{this.seenElements.has(e.target)&&this.sendAutoImpression(e.target,e.boundingClientRect,"appear"),i.delete(e.target)}),1e3);i.set(e.target,t),this.seenElements.add(e.target)}else if(!e.isIntersecting&&this.seenElements.has(e.target)){const t=i.get(e.target);t?(clearTimeout(t),i.delete(e.target)):this.sendAutoImpression(e.target,e.boundingClientRect,"disappear"),this.seenElements.delete(e.target)}}))}))}),{root:null,threshold:.2});const a=e=>{if(!e||1!==e.nodeType)return;if(e.dataset&&e.dataset.moveoObserved)return;(e.matches&&e.matches(t.join(","))||(e=>!!e.childNodes.length&&[...e.childNodes].some((e=>3===e.nodeType&&e.textContent.trim().length>=15)))(e))&&(this.impressionObserver.observe(e),e.dataset.moveoObserved="true")},s=()=>{document.querySelectorAll("*").forEach(a),setTimeout((()=>{document.querySelectorAll("*").forEach((t=>{if(t.dataset&&t.dataset.moveoObserved){const i=t.getBoundingClientRect();i.top<e.innerHeight&&i.bottom>0&&i.width>0&&i.height>0&&!this.seenElements.has(t)&&(this.seenElements.add(t),this.sendAutoImpression(t,i,"appear"))}}))}),100)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s();new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{1===e.nodeType&&(a(e),e.querySelectorAll&&e.querySelectorAll("*").forEach(a))}))}))})).observe(document.documentElement,{childList:!0,subtree:!0}),e.addEventListener("beforeunload",(()=>{i.forEach((e=>{clearTimeout(e)})),i.clear()}))}sendAutoImpression(e,t,i){if(!this.started)return void this.pendingImpressions.push({el:e,rect:t,action:i,timestamp:Date.now()});let n="";n=e.matches("img")?e.alt||e.title||this.getFilenameFromUrl(e.currentSrc||e.src)||"image":e.matches("video")?e.title||this.getFilenameFromUrl(e.currentSrc||e.src)||"video":e.matches("iframe")?e.title||this.getFilenameFromUrl(e.src)||"embedded_content":e.matches("a")?(e.innerText||e.textContent||"").trim()||e.href||"link":e.matches('button,input,[role="button"]')?(e.innerText||e.value||e.getAttribute("aria-label")||"").trim()||"button":e.matches("h1,h2,h3")?(e.innerText||e.textContent||"").trim()||"heading":(e.innerText||e.textContent||"").trim()||"text";const a={semanticGroup:this.getSemanticGroup(e),id:this.generateStableElementId(e),type:e.tagName.toLowerCase(),action:i,value:n};this.track("impression",a)}getFilenameFromUrl(e){if(!e)return"";try{const t=new URL(e).pathname;return t.split("/").pop()||""}catch(t){const i=e.split("/");return i[i.length-1]||""}}cleanUrl(e){if(!e)return"";try{const t=new URL(e);return t.origin+t.pathname}catch(t){return e}}getElementText(e){if(!e||"object"!=typeof e)return"";if(!e.tagName||"string"!=typeof e.tagName)return"";try{if("INPUT"===e.tagName)return(e.type||"input").toString();if("SELECT"===e.tagName)return(e.name||"select").toString();if("TEXTAREA"===e.tagName)return"textarea";if("IMG"===e.tagName)return(e.alt||e.title||"image").toString();let t="";if(e.childNodes&&e.childNodes.length>0)for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i];n&&n.nodeType===Node.TEXT_NODE&&n.textContent&&(t+=n.textContent)}return t=t.trim().replace(/\s+/g," "),t.length>100?t.substring(0,97)+"...":t}catch(e){return console.warn("MoveoOne: Error getting element text:",e),""}}getElementFullText(e){if(!e||"object"!=typeof e)return"";if(!e.tagName||"string"!=typeof e.tagName)return"";try{if("INPUT"===e.tagName)return(e.type||"input").toString();if("SELECT"===e.tagName)return(e.name||"select").toString();if("TEXTAREA"===e.tagName)return"textarea";if("IMG"===e.tagName)return(e.alt||e.title||"image").toString();let t="";if(e.childNodes&&e.childNodes.length>0)for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i];n&&n.nodeType===Node.TEXT_NODE&&n.textContent&&(t+=n.textContent)}return t=t.trim().replace(/\s+/g," "),t}catch(e){return console.warn("MoveoOne: Error getting element full text:",e),""}}getSemanticGroup(t){if(!t||t===document||t===e)return"global";const i=["article","aside","nav","header","footer"];let n=t,a=null;for(;n&&n!==document.body;){if("section"===n.tagName.toLowerCase()){a=n;break}n=n.parentElement}if(a)return this.getSemanticGroupName(a,!1);n=t;let s=null;for(;n&&n!==document.body;){if("div"===n.tagName.toLowerCase()&&n.id&&n.id.trim()){s=n;break}n=n.parentElement}if(s)return this.getSemanticGroupName(s,!1);n=t;let o=null;for(;n&&n!==document.body;){const e=n.tagName.toLowerCase();if(i.includes(e)){o=n;break}n=n.parentElement}return o?this.getSemanticGroupName(o,!0):"global"}getSemanticGroupName(e,t){const i=e.tagName.toLowerCase();if(e.id&&e.id.trim()){const n=this.cleanSemanticGroupName(e.id);return t?`${i}_${n}`:n}if(e.className&&e.className.trim()){const n=e.className.split(" ").filter((e=>e.trim())),a=n.filter((e=>{const t=e.toLowerCase();return!t.match(/^(bg-|text-|p-|m-|w-|h-|flex|grid|block|inline|hidden|visible|opacity|border|rounded|shadow|transition|transform|hover|focus|active|disabled|container|row|col|btn|card|modal|nav|header|footer|sidebar|main|content|wrapper|section|article|aside|w-|w-embed|w-script|w-dyn-|w-tab-|w-form-|max-|min-|items-|justify-|self-|place-|gap-|space-|order-|col-span-|row-span-|aspect-|object-|overflow-|z-|relative|absolute|fixed|sticky|top-|right-|bottom-|left-|inset-)$/)&&!t.includes("active")&&!t.includes("hidden")}));if(a.length>0){const e=this.cleanSemanticGroupName(a[0]);return t?`${i}_${e}`:e}const s=n.filter((e=>!e.toLowerCase().match(/^(container|wrapper|content|section|main|header|footer|nav|sidebar|row|col|btn|card|modal|w-|w-embed|w-script|w-dyn-|w-tab-|w-form-)$/)));if(s.length>0){const e=this.cleanSemanticGroupName(s[0]);return t?`${i}_${e}`:e}}const n=e.parentElement;if(n){const t=Array.from(n.children).filter((e=>e.tagName.toLowerCase()===i));if(t.length>1){const n=t.indexOf(e)+1;return`${i}_${n}`}}return t?`${i}_element`:i}cleanSemanticGroupName(e){if(!e)return"global";let t=e.replace(/^[_-]+/,"").replace(/[_-]+$/,"").replace(/[_-]+/g,"_").replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase();return t.length>50&&(t=t.substring(0,50)),t||"global"}shouldTrackElement(e){const t=e.getBoundingClientRect();if(0===t.width||0===t.height)return!1;if(["SCRIPT","STYLE","NOSCRIPT","META","LINK","HEAD","TITLE"].includes(e.tagName))return!1;const i=this.getElementText(e);return!(!i||i.length<2)&&((!e.id||!e.id.includes("moveo"))&&(!e.className||!e.className.includes("moveo")))}setupHoverTracking(){let e;document.addEventListener("mouseover",(t=>{const i=t.target;clearTimeout(e),this.shouldTrackElement(i)&&(e=setTimeout((()=>{const e=this.getElementFullText(i),t={semanticGroup:this.getSemanticGroup(i),id:this.generateStableElementId(i),type:i.tagName.toLowerCase(),action:"hover",value:e};this.track("hover",t)}),1500))})),document.addEventListener("mouseout",(t=>{clearTimeout(e)}))}async trackPageNavigation(){const t={c:this.context,type:"track",userId:this.userId,t:Date.now(),prop:{sg:"global",eID:this.generateGlobalEventId("page_view",{path:e.location.pathname}),eA:"page_view",eT:"page",eV:e.location.pathname||"",sc:e.location.pathname||"unknown"},sId:this.sessionId};this.sendEventImmediate(t)}isOutboundLink(t){try{const i=new URL(t,e.location.href),n=e.location.hostname;return i.hostname!==n&&i.protocol.startsWith("http")}catch(e){return!1}}setupDownloadOrOutboundLinkTracking(){const e=()=>{document.querySelectorAll("a[href]").forEach((e=>{if(e.dataset.moveoLinkTracked)return;const t=e.href,i=t.match(/\.(pdf|zip|docx?|xlsx?|pptx?|txt|csv|json|xml|gz|tar|rar|7z|exe|dmg|pkg|deb|rpm|iso|img|mp3|mp4|avi|mov|wmv|flv|webm|ogg|wav|flac)$/i),n=this.isOutboundLink(t);(i||n)&&(e.dataset.moveoLinkTracked="true",e.addEventListener("click",(a=>{if(i){const i=t.split("/").pop()||t;i.split(".").pop();this.trackImmediate("download",{semanticGroup:this.getSemanticGroup(e),id:this.generateStableElementId(e),type:"download",action:"click",value:i}),console.log("MoveoOne: Download tracked -",i)}else if(n){const i=new URL(t).hostname;this.trackImmediate("outbound_link",{semanticGroup:this.getSemanticGroup(e),id:this.generateStableElementId(e),type:"outbound_link",action:"click",value:t}),console.log("MoveoOne: Outbound link tracked -",i)}})))}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e();const t=()=>{const t=document.body||document.documentElement;if(t){new MutationObserver((()=>{e()})).observe(t,{childList:!0,subtree:!0})}};document.body?t():document.addEventListener("DOMContentLoaded",t)}setupPageUnloadTracking(){e.addEventListener("beforeunload",(()=>{if(this.buffer.length>0){const e=JSON.stringify({events:[...this.buffer]});fetch(t,{method:"POST",headers:{Authorization:this.token,"Content-Type":"application/json"},body:e,keepalive:!0}).catch((e=>console.error("MoveoOne Unload Error:",e)))}this.updateSessionActivity()})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?(this.updateSessionActivity(),this.buffer.length>0&&this.flush(),this.track("visibility_change",{semanticGroup:"global",id:this.generateGlobalEventId("visibility_change",{state:"hidden"}),type:"hidden",action:"visibility_change",value:"page_hidden"})):"visible"===document.visibilityState&&(this.updateSessionActivity(),this.track("visibility_change",{semanticGroup:"global",id:this.generateGlobalEventId("visibility_change",{state:"visible"}),type:"visible",action:"visibility_change",value:"page_visible"}))}))}setupMediaTracking(){const e=()=>{document.querySelectorAll("video, audio").forEach((e=>{if(e.dataset.moveoTracked)return;e.dataset.moveoTracked="true";const t=e.tagName.toLowerCase(),i=this.generateStableElementId(e);e.addEventListener("play",(()=>{this.track("media_play",{semanticGroup:this.getSemanticGroup(e),id:i,type:t,action:"media_play"})})),e.addEventListener("pause",(()=>{this.track("media_pause",{semanticGroup:this.getSemanticGroup(e),id:i,type:t,action:"media_pause"})})),e.addEventListener("ended",(()=>{this.track("media_complete",{semanticGroup:this.getSemanticGroup(e),id:i,type:t,action:"media_complete"})}))}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e();const t=()=>{const t=document.body||document.documentElement;if(t){new MutationObserver((()=>{e()})).observe(t,{childList:!0,subtree:!0})}};document.body?t():document.addEventListener("DOMContentLoaded",t)}setupClipboardTracking(){document.addEventListener("copy",(t=>{const i=e.getSelection().toString();if(i&&i.trim().length>0){const t=e.getSelection(),n=t.anchorNode?t.anchorNode.nodeType===Node.ELEMENT_NODE?t.anchorNode:t.anchorNode.parentElement:null;this.track("copy",{semanticGroup:this.getSemanticGroup(n),id:n?this.generateStableElementId(n):"copy_text",type:"clipboard",action:"copy",value:i})}}))}flush(){if(0===this.buffer.length)return;const e=[...this.buffer];this.buffer=[],console.log("MoveoOne: Sending events",e),e.forEach(((e,t)=>{console.log(`Event ${t}:`,{type:e.type,context:e.c,sessionId:e.sId,eA:e.prop.eA,eT:e.prop.eT,eV:e.prop.eV,sc:e.prop.sc,meta:e.meta,additionalMeta:e.additionalMeta})})),fetch(t,{method:"POST",headers:{Authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({events:e})}).catch((e=>console.error("MoveoOne Error:",e)))}setupClickTracking(){document.addEventListener("click",(t=>{let i=t.target;if(!this.shouldTrackElement(i))return;if("A"===i.tagName&&i.href){const e=i.href.match(/\.(pdf|zip|docx?|xlsx?|pptx?|txt|csv|json|xml|gz|tar|rar|7z|exe|dmg|pkg|deb|rpm|iso|img|mp3|mp4|avi|mov|wmv|flv|webm|ogg|wav|flac)$/i),t=this.isOutboundLink(i.href);if(e||t)return}const n=this.getElementFullText(i),a={semanticGroup:this.getSemanticGroup(i),id:this.generateStableElementId(i),type:i.tagName.toLowerCase(),action:"click",value:n};if("A"===i.tagName&&i.href)try{const t=new URL(i.href,e.location.href),n=new URL(e.location.href);if(t.hostname===n.hostname&&t.pathname!==n.pathname)return void this.trackImmediate("click",a)}catch(e){console.warn("MoveoOne: Failed to parse URL for click tracking:",e)}this.track("click",a)}))}setupScrollTracking(){let t,i=0;e.addEventListener("scroll",(()=>{clearTimeout(t),t=setTimeout((()=>{const t=e.scrollY,n=document.documentElement.scrollHeight-e.innerHeight,a=Math.round(t/n*100);Math.abs(t-i)>100&&(this.track("scroll",{semanticGroup:"global",id:this.generateGlobalEventId("scroll",{scrollPercentage:a}),type:"scroll",action:"scroll",value:a.toString()}),i=t)}),500)}))}setupFormTracking(){document.addEventListener("submit",(e=>{const t=e.target;this.trackImmediate("form_submit",{semanticGroup:this.getSemanticGroup(t),id:this.generateStableElementId(t),type:"form",action:"form_submit",value:""})})),document.addEventListener("change",(e=>{const t=e.target;["select","input","textarea"].includes(t.tagName.toLowerCase())&&this.track("form_change",{semanticGroup:this.getSemanticGroup(t),id:this.generateStableElementId(t),type:t.type||t.tagName.toLowerCase(),action:"form_change",value:"password"===t.type?"[REDACTED]":t.value})}))}setupResizeTracking(){let t;e.addEventListener("resize",(()=>{clearTimeout(t),t=setTimeout((()=>{const t={width:e.innerWidth,height:e.innerHeight};(Math.abs(t.width-this.currentViewport.width)>50||Math.abs(t.height-this.currentViewport.height)>50)&&(this.track("viewport_resize",{semanticGroup:"global",id:this.generateGlobalEventId("viewport_resize",{width:t.width,height:t.height}),type:"resize",action:"viewport_resize",value:`${t.width}x${t.height}`}),this.currentViewport=t)}),300)}))}getElementPath(e){const t=[];for(;e&&e.nodeType===Node.ELEMENT_NODE;){let i=e.nodeName.toLowerCase();e.id?i+="#"+e.id:e.className&&(i+="."+e.className.replace(/\s+/g,".")),t.unshift(i),e=e.parentNode}return t.join(" > ")}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}generateStableElementId(e){if(e.id&&e.id.trim())return this.cleanElementId(e.id);const t=this.buildStableSignature(e),i=this.hashString(JSON.stringify(t)),n=`${e.tagName.toLowerCase()}_${i}`;return this.cleanElementId(n)}buildStableSignature(e){return{tag:e.tagName.toLowerCase(),stableAttributes:this.getStableAttributes(e),stableContent:this.getStableContent(e)}}getStableAttributes(e){const t={};if(e.name&&(t.name=e.name),e.type&&(t.type=e.type),e.title&&(t.title=e.title),e.alt&&(t.alt=e.alt),e.className&&e.className.trim()){const i=e.className.split(" ").filter((e=>e.trim())).filter((e=>{const t=e.toLowerCase();return!t.match(/^(bg-|text-|p-|m-|w-|h-|flex|grid|block|inline|hidden|visible|opacity|border|rounded|shadow|transition|transform|hover|focus|active|disabled|container|row|col|btn|card|modal|nav|header|footer|sidebar|main|content|wrapper|section|article|aside|w-|w-embed|w-script|w-dyn-|w-tab-|w-form-|max-|min-|items-|justify-|self-|place-|gap-|space-|order-|col-span-|row-span-|aspect-|object-|overflow-|z-|relative|absolute|fixed|sticky|top-|right-|bottom-|left-|inset-)$/)&&!t.includes("active")&&!t.includes("hidden")}));i.length>0&&(t.meaningfulClass=this.cleanSemanticGroupName(i[0]))}return t}getStableContent(e){const t={},i=this.getElementText(e);return i&&i.trim().length>0&&("INPUT"===e.tagName&&"hidden"!==e.type||(t.text=i.trim())),"A"===e.tagName&&e.href&&(t.href=e.href),"IMG"===e.tagName&&e.src&&(t.src=e.src),"VIDEO"!==e.tagName&&"AUDIO"!==e.tagName||!e.src||(t.src=e.src),t}cleanElementId(e){return e?e.replace(/[^a-zA-Z0-9_-]/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"").toLowerCase().substring(0,50):"unnamed_element"}hashString(e){if(!e)return"empty";"object"==typeof e&&(e=JSON.stringify(e,Object.keys(e).sort()));let t=5381;for(let i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i),t&=4294967295;return Math.abs(t).toString(16).padStart(8,"0")}generateGlobalEventId(t,i={}){let n=t;if(i.path&&(n+=`_${this.hashString(i.path)}`),i.value&&(n+=`_${this.hashString(i.value)}`),i.action&&(n+=`_${i.action}`),"page_view"===t||"viewport_size"===t){const t=e.location.pathname;n+=`_${this.hashString(t)}`}"scroll"===t&&i.scrollPercentage&&(n+=`_${i.scrollPercentage}`),"viewport_resize"===t&&i.width&&i.height&&(n+=`_${i.width}x${i.height}`);return`${t}_${this.hashString(n)}`}}e.MoveoOne={init:function(t,a={}){const s=new n(t),o=["locale","test","softwareVersion"];return Object.keys(a).forEach((e=>{if(o.includes(e))switch(e){case"locale":"string"==typeof a[e]&&(s.meta.locale=a[e]);break;case"test":"string"==typeof a[e]&&(s.meta.test=a[e]);break;case"softwareVersion":"string"==typeof a[e]&&(s.meta.softwareVersion=a[e])}else"libVersion"===e?console.warn(`MoveoOne: libVersion is automatically set to "${i}" and cannot be overridden by client code.`):console.warn(`MoveoOne: Invalid meta field "${e}" ignored. Allowed fields: ${o.join(", ")}. Note: libVersion is automatically included.`)})),s.initialize(),e.MoveoOne.instance=s,s},getLibVersion:function(){return i}}}(window);