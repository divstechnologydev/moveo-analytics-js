!function(t){if(t.MoveoOne)return;class e{constructor(e){this.token=e,this.userId="",this.buffer=[],this.flushInterval=1e4,this.maxThreshold=500,this.context=t.location.pathname,this.sessionId=this.generateUUID(),this.started=!1,setInterval((()=>this.flush()),this.flushInterval)}initialize(){this.start(),this.track("page_view",{semanticGroup:"navigation",id:t.location.pathname,type:"page",action:"view",value:document.title}),this.setupClickTracking(),this.setupScrollTracking(),this.setupFormTracking()}identify(t){this.userId=t}track(t,e){const n={c:this.context,type:"track",userId:this.userId,t:Date.now(),prop:{sg:e.semanticGroup,eID:e.id,eA:e.action,eT:e.type,eV:e.value||""},meta:e.metadata||{},sId:this.sessionId};this.buffer.push(n),this.buffer.length>=this.maxThreshold&&this.flush()}updateMetadata(t){this.buffer=this.buffer.map((e=>({...e,meta:{...e.meta,...t}})))}enrichWithGeolocation(){return fetch("https://ipapi.co/json/").then((t=>t.json())).then((t=>({location:JSON.stringify({ip:t.ip,city:t.city,region:t.region,country:t.country_name,countryCode:t.country_code,postal:t.postal,latitude:t.latitude,longitude:t.longitude,org:t.org})}))).catch((t=>(console.warn("MoveoOne: Failed to enrich geolocation",t),{})))}async start(){const e={c:this.context,type:"start_session",userId:this.userId,t:Date.now(),prop:{},meta:{},sId:this.sessionId},n=new URLSearchParams(t.location.search),i=n.get("utm_source")||"",a=n.get("utm_medium")||"",o=n.get("utm_campaign")||"",r={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language||navigator.userLanguage,screenResolution:`${t.screen.width}x${t.screen.height}`,viewportSize:`${t.innerWidth}x${t.innerHeight}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,referrer:document.referrer||"",utm_source:i,utm_medium:a,utm_campaign:o,returningVisitor:localStorage.getItem("moveo-returning")||"false"};localStorage.getItem("moveo-returning")||localStorage.setItem("moveo-returning","true");const s=await this.enrichWithGeolocation();e.meta={...r,...s},this.buffer.push(e),this.flush()}flush(){if(0===this.buffer.length)return;const t=[...this.buffer];this.buffer=[],fetch("https://api.moveo.one/api/analytic/event",{method:"POST",headers:{Authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({events:t})}).catch((t=>console.error("MoveoOne Error:",t)))}setupClickTracking(){document.addEventListener("click",(t=>{let e=t.target,n=e.tagName.toLowerCase();if(!["a","button","input","select"].includes(n)){if(e=e.closest('a, button, input[type="button"], input[type="submit"], select'),!e)return;n=e.tagName.toLowerCase()}const i={semanticGroup:"interaction",id:e.id||e.name||e.href||"unnamed_element",type:n,action:"click",value:e.textContent?.trim()||e.value||"",metadata:{path:`${this.getElementPath(e)}`,href:`${e.href}`}};this.track("click",i)}))}setupScrollTracking(){let e,n=0;t.addEventListener("scroll",(()=>{clearTimeout(e),e=setTimeout((()=>{const e=t.scrollY,i=Math.round(e/(document.documentElement.scrollHeight-t.innerHeight)*100);Math.abs(e-n)>100&&(this.track("scroll",{semanticGroup:"interaction",id:"page_scroll",type:"scroll",action:"scroll",value:i.toString(),metadata:{position:`${e}`}}),n=e)}),500)}))}setupFormTracking(){document.addEventListener("submit",(t=>{const e=t.target;this.track("form_submit",{semanticGroup:"interaction",id:e.id||e.name||"unnamed_form",type:"form",action:"submit",value:"",metadata:{path:`${this.getElementPath(e)}`}})})),document.addEventListener("change",(t=>{const e=t.target;["select","input","textarea"].includes(e.tagName.toLowerCase())&&this.track("form_change",{semanticGroup:"interaction",id:e.id||e.name||"unnamed_input",type:e.type||e.tagName.toLowerCase(),action:"change",value:"password"===e.type?"[REDACTED]":e.value,metadata:{path:`${this.getElementPath(e)}`}})}))}getElementPath(t){const e=[];for(;t&&t.nodeType===Node.ELEMENT_NODE;){let n=t.nodeName.toLowerCase();t.id?n+="#"+t.id:t.className&&(n+="."+t.className.replace(/\s+/g,".")),e.unshift(n),t=t.parentNode}return e.join(" > ")}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}}t.MoveoOne={init:function(t){const n=new e(t);return n.initialize(),n}}}(window);